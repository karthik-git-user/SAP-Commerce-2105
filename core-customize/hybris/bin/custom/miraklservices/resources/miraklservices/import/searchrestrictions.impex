INSERT_UPDATE SearchRestriction; code[unique = true]; name[lang = en]; principal(uid)[unique = true]; query; restrictedType(code)[unique = true]; active[default = true]; generate[default = false]
;Frontend_Offer ; "Offer Frontend Visiblity" ; customergroup ; {item:active} = 1 AND {item:deleted} = 0 AND {item:quantity} > 0 AND NOT (({item:availableStartDate} > ?session.user.currentDate AND {item:availableStartDate} IS NOT NULL) OR ({item:availableEndDate} < ?session.user.currentDate AND {item:availableEndDate} IS NOT NULL)) ; Offer
;Frontend_ConsignmentEntry ; "ConsignmentEntry Frontend Visibility" ; customergroup ; EXISTS({{SELECT {pk}, {oe:order}, {o:user} FROM {ConsignmentEntry AS ce JOIN OrderEntry AS oe ON {ce:OrderEntry} = {oe:pk} JOIN Order AS o ON {oe:order} = {o:pk}} WHERE ({o:user} = ?session.user OR ?session.user.uid = 'anonymous') AND {ce:pk} = {item:pk}}}) ; ConsignmentEntry
;Frontend_MarketplaceConsignment ; "MarketplaceConsignment Frontend Visiblity" ; customergroup ; EXISTS({{SELECT {pk}, {o:user} FROM {MarketplaceConsignment AS mc JOIN Order AS o ON {mc:order} = {o:pk}} WHERE ({o:user} = ?session.user OR ?session.user.uid = 'anonymous') AND {mc:pk} = {item:pk}}}) ; MarketplaceConsignment
